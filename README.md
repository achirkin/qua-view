# qua-view
Web app written in Haskell (GHCJS) for visualizing building geometry.
This is a part of **qua-kit** project - **Quick Urban Analysis Kit** -
that is being developed under the scope of [ADvISE](http://www.ia.arch.ethz.ch/advise/) reseach project.
Qua-view can be compiled into a standalone javascript application, independent of the main project.
Other parts are responsible for a server side.

besides ghcjs depends on https://github.com/achirkin/ghcjs-webgl and https://github.com/achirkin/fastvec

Compiled application currently is available on http://www.ia.arch.ethz.ch/modeler.html

Supports mouse and finger control. Works best on chrome (desktop or mobile), but most other browsers working too.

### Reactive programming

While trying to get familiar with FRP approach I decided to make my own minimalistic implementation of it.
The module `Reactive` provides functions to run the main application cycle and to process various kinds of events.

Creating a reaction (program -> program) and a response (view -> IO view) of a program means implementing `Reaction` class. The module uses Template Haskell (`createAllEventSenses`) to aggregate all instances of `Reaction` and create processing lists for all available types of events (`EventSense` instances). To pass events to the main cycle I use single MVar for type `EventBox`. One can put inside any instance of `EventSense` (which is generated by TH).

In current version my implementation of FRP has following problems:

* Difficult to share computations between `react` and `response`.
* Difficult to create events inside program (in contrast to external events like mouse clicks or other js events).
* Some parts of api are ugly :(

### GHCJS + WebGL issues

* It would be nice to unify interface of WebGL and OpenGL libraries. Now the differencies are significant.
* It also would be nice to connect ghcjs-dom and ghcjs-webgl to be able to compile the same app using both - ghcjs and ghc.
